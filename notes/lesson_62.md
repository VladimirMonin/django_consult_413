# Lesson 62 - Django –°–∏–≥–Ω–∞–ª—ã

## –ß—Ç–æ —Ç–∞–∫–æ–µ Django –°–∏–≥–Ω–∞–ª—ã? üì°

–°–∏–≥–Ω–∞–ª—ã –≤ Django ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–º —á–∞—Å—Ç—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–±—ã—Ç–∏—è. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ —Å–∏—Å—Ç–µ–º—É –æ–ø–æ–≤–µ—â–µ–Ω–∏–π: –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–æ–¥–µ–ª—å), Django –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç "—Å–∏–≥–Ω–∞–ª", –∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ –Ω–µ–≥–æ "–ø–æ–¥–ø–∏—Å–∞–Ω—ã", –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è. –≠—Ç–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å" (Observer).

### –ì–¥–µ –µ—â–µ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—É—é –ª–æ–≥–∏–∫—É? ü§î

–ö–æ–Ω–µ—á–Ω–æ, —Å–∏–≥–Ω–∞–ª—ã ‚Äî –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–±—ã—Ç–∏—è –≤ Django. –ü–æ—Ö–æ–∂—É—é –ª–æ–≥–∏–∫—É –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–æ–∏—Ç—å –∏ –≤ –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–æ—Ä–º—ã, –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ `save()` –≤ —Å–∞–º–æ–π —Ñ–æ—Ä–º–µ ([`core/forms.py`](core/forms.py:1)) –∏–ª–∏ –≤ –º–æ–¥–µ–ª–∏ ([`core/models.py`](core/models.py:1)). –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –º–æ–∂–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤–æ `view`-—Ñ—É–Ω–∫—Ü–∏–∏ ([`core/views.py`](core/views.py:1)) –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.

>[!info]
>
>#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã
>
>–õ–æ–≥–∏–∫—É, —Å—Ö–æ–∂—É—é —Å —Å–∏–≥–Ω–∞–ª–∞–º–∏, –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:
>
>- –í –º–µ—Ç–æ–¥–∞—Ö –º–æ–¥–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `save()`, `delete()`).
>- –í –º–µ—Ç–æ–¥–∞—Ö —Ñ–æ—Ä–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `clean()`, `save()`).
>- –ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤–æ `views`.

–¢–∞–∫ –≤ —á–µ–º –∂–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤? –û–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç **"—Ä–∞–∑–≤—è–∑–∞—Ç—å" (decouple)** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–µ–µ —Å–∏–≥–Ω–∞–ª, –Ω–µ –æ–±—è–∑–∞–Ω–æ –∑–Ω–∞—Ç—å, –∫—Ç–æ –∏ –∫–∞–∫ –Ω–∞ –Ω–µ–≥–æ –æ—Ç—Ä–µ–∞–≥–∏—Ä—É–µ—Ç.

### –ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª—ã? ‚úÖ

–°–∏–≥–Ω–∞–ª—ã –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω—ã, –∫–æ–≥–¥–∞:

- –í–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–∞ –æ–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —á–∞—Å—Ç–µ–π —Å–∏—Å—Ç–µ–º—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–º—É –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ, —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∏ –∑–∞–ø–∏—Å–∞—Ç—å –ª–æ–≥.
- –í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ (`reusable apps`). –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∏–∑–º–µ–Ω—è—Ç—å –∫–æ–¥ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤—ã –º–æ–∂–µ—Ç–µ "–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è" –Ω–∞ –µ–≥–æ —Å–∏–≥–Ω–∞–ª—ã –∏ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é –ª–æ–≥–∏–∫—É.
- –õ–æ–≥–∏–∫–∞ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª—å—é –∏–ª–∏ `view`, –∞ –Ω–æ—Å–∏—Ç –±–æ–ª–µ–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–π, —Å–∫–≤–æ–∑–Ω–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä.

### –°–∏–≥–Ω–∞–ª—ã –∏ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á: –≤ —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞? üö¶

–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —Å–∏–≥–Ω–∞–ª—ã –≤ Django –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã**. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–≥–¥–∞ —Å–∏–≥–Ω–∞–ª –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP-–∑–∞–ø—Ä–æ—Å–∞) –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É.

>[!warning]
>
>#### –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
>
>–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç–æ–º –∂–µ –ø–æ—Ç–æ–∫–µ, —á—Ç–æ –∏ –∫–æ–¥, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–≤—à–∏–π —Å–∏–≥–Ω–∞–ª. –ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–æ–ª–≥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∫—É email –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π), —ç—Ç–æ –º–æ–∂–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –∑–∞–º–µ–¥–ª–∏—Ç—å –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —Å–∏–≥–Ω–∞–ª—ã **–Ω–µ —è–≤–ª—è—é—Ç—Å—è –∑–∞–º–µ–Ω–æ–π** –¥–ª—è —Å–∏—Å—Ç–µ–º –æ—á–µ—Ä–µ–¥–µ–π –∑–∞–¥–∞—á, —Ç–∞–∫–∏—Ö –∫–∞–∫ Celery –∏–ª–∏ Redis Queue (RQ). –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫—É—é –∏–ª–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á. –°–∏–≥–Ω–∞–ª –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–µ—Ç –≤—ã—Å—Ç—É–ø–∏—Ç—å –≤ —Ä–æ–ª–∏ "—Ç—Ä–∏–≥–≥–µ—Ä–∞", –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—Ç–∞–≤–∏—Ç –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å, –Ω–æ —Å–∞–º–∞ –∑–∞–¥–∞—á–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.

–í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ –º—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ —Ç–∏–ø—ã —Å–∏–≥–Ω–∞–ª–æ–≤ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ Django –∏ –∫–∞–∫ —Å –Ω–∏–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å.

## –¢–∏–ø—ã —Å–∏–≥–Ω–∞–ª–æ–≤ üìä

Django –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∞—è —á–∞—Å—Ç—å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –∏—Ö –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–º–∏ –∏–∑ –Ω–∏—Ö, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ —á–∞—Å—Ç–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

| –°–∏–≥–Ω–∞–ª | –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ | –û—Å–Ω–æ–≤–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ |
| :--- | :--- | :--- | :--- |
| **–°–∏–≥–Ω–∞–ª—ã –º–æ–¥–µ–ª–µ–π (`django.db.models.signals`)** |
| `pre_save` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–∏. | `sender`: –ö–ª–∞—Å—Å –º–æ–¥–µ–ª–∏.<br>`instance`: –≠–∫–∑–µ–º–ø–ª—è—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.<br>`raw`: `True`, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Ñ–∏–∫—Å—Ç—É—Ä.<br>`using`: –ü—Å–µ–≤–¥–æ–Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ë–î.<br>`update_fields`: –ù–∞–±–æ—Ä –ø–æ–ª–µ–π –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. | `def h(sender, instance, **kwargs):` |
| `post_save` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏. | `sender`: –ö–ª–∞—Å—Å –º–æ–¥–µ–ª–∏.<br>`instance`: –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä.<br>`created`: `True`, –µ—Å–ª–∏ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å.<br>`raw`: `True`, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∏–∫—Å—Ç—É—Ä.<br>`using`: –ü—Å–µ–≤–¥–æ–Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ë–î.<br>`update_fields`: –ù–∞–±–æ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π. | `def h(sender, instance, created, **kwargs):` |
| `pre_delete` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–∏. | `sender`: –ö–ª–∞—Å—Å –º–æ–¥–µ–ª–∏.<br>`instance`: –£–¥–∞–ª—è–µ–º—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä.<br>`using`: –ü—Å–µ–≤–¥–æ–Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ë–î.<br>`origin`: –û–±—ä–µ–∫—Ç, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–≤—à–∏–π —É–¥–∞–ª–µ–Ω–∏–µ. | `def h(sender, instance, **kwargs):` |
| `post_delete` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏. | `sender`: –ö–ª–∞—Å—Å –º–æ–¥–µ–ª–∏.<br>`instance`: –£–¥–∞–ª–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä.<br>`using`: –ü—Å–µ–≤–¥–æ–Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ë–î.<br>`origin`: –û–±—ä–µ–∫—Ç, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–≤—à–∏–π —É–¥–∞–ª–µ–Ω–∏–µ. | `def h(sender, instance, **kwargs):` |
| `m2m_changed` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `ManyToManyField`. | `sender`: –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –º–æ–¥–µ–ª—å `m2m`-—Å–≤—è–∑–∏.<br>`instance`: –≠–∫–∑–µ–º–ø–ª—è—Ä, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å —Å–≤—è–∑—å.<br>`action`: –¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (`pre_add`, `post_add` –∏ —Ç.–¥.).<br>`reverse`: `True`, –µ—Å–ª–∏ —Å–≤—è–∑—å –º–µ–Ω—è–µ—Ç—Å—è —Å "–æ–±—Ä–∞—Ç–Ω–æ–π" —Å—Ç–æ—Ä–æ–Ω—ã.<br>`model`: –ö–ª–∞—Å—Å –º–æ–¥–µ–ª–∏, –æ–±—ä–µ–∫—Ç—ã –∫–æ—Ç–æ—Ä–æ–π –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è/—É–¥–∞–ª—è—é—Ç—Å—è.<br>`pk_set`: –ù–∞–±–æ—Ä `id` –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.<br>`using`: –ü—Å–µ–≤–¥–æ–Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ë–î. | `def h(sender, instance, action, **kwargs):` |
| `pre_init` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ `__init__()` –º–æ–¥–µ–ª–∏. | `sender`: –ö–ª–∞—Å—Å –º–æ–¥–µ–ª–∏.<br>`args`, `kwargs`: –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –≤ `__init__()`. | `def h(sender, *args, **kwargs):` |
| `post_init` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ `__init__()` –º–æ–¥–µ–ª–∏. | `sender`: –ö–ª–∞—Å—Å –º–æ–¥–µ–ª–∏.<br>`instance`: –°–æ–∑–¥–∞–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä. | `def h(sender, instance, **kwargs):` |
| **–°–∏–≥–Ω–∞–ª—ã –∑–∞–ø—Ä–æ—Å–∞/–æ—Ç–≤–µ—Ç–∞ (`django.core.signals`)** |
| `request_started` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞. | `sender`: –ö–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞.<br>`environ`: –°–ª–æ–≤–∞—Ä—å `WSGI` –æ–∫—Ä—É–∂–µ–Ω–∏—è. | `def h(sender, environ, **kwargs):` |
| `request_finished` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É. | `sender`: –ö–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. | `def h(sender, **kwargs):` |
| `got_request_exception` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ. | `sender`: –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (`None`).<br>`request`: –û–±—ä–µ–∫—Ç `HttpRequest`. | `def h(sender, request, **kwargs):` |
| **–°–∏–≥–Ω–∞–ª—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`django.contrib.auth.signals`)** |
| `user_logged_in` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞. | `sender`: –ö–ª–∞—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.<br>`request`: –û–±—ä–µ–∫—Ç `HttpRequest`.<br>`user`: –≠–∫–∑–µ–º–ø–ª—è—Ä –≤–æ—à–µ–¥—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. | `def h(sender, request, user, **kwargs):` |
| `user_logged_out` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. | `sender`: –ö–ª–∞—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.<br>`request`: –û–±—ä–µ–∫—Ç `HttpRequest`.<br>`user`: –≠–∫–∑–µ–º–ø–ª—è—Ä –≤—ã—à–µ–¥—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. | `def h(sender, request, user, **kwargs):` |
| `user_login_failed` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞. | `sender`: –ò–º—è –º–æ–¥—É–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.<br>`credentials`: –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.<br>`request`: –û–±—ä–µ–∫—Ç `HttpRequest`. | `def h(sender, credentials, request, **kwargs):` |
| **–°–∏–≥–Ω–∞–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π (`django.db.models.signals`)** |
| `pre_migrate` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–π. | `sender`: `AppConfig` –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.<br>`app_config`: –¢–æ –∂–µ, —á—Ç–æ –∏ `sender`.<br>`plan`: –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π. | `def h(sender, app_config, **kwargs):` |
| `post_migrate` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π. | `sender`: `AppConfig` –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.<br>`app_config`: –¢–æ –∂–µ, —á—Ç–æ –∏ `sender`.<br>`plan`: –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π. | `def h(sender, app_config, **kwargs):` |
| **–ü—Ä–æ—á–∏–µ —Å–∏–≥–Ω–∞–ª—ã** |
| `connection_created` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î. | `sender`: –ö–ª–∞—Å—Å-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –ë–î.<br>`connection`: –û—Ç–∫—Ä—ã—Ç–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. | `def h(sender, connection, **kwargs):` |
| `setting_changed` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —Ç–µ—Å—Ç–∞—Ö. | `sender`: `TestCase` –∏–ª–∏ `None`.<br>`setting`: –ò–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.<br>`value`: –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.<br>`enter`: `True` –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ, `False` –ø—Ä–∏ —Å–±—Ä–æ—Å–µ. | `def h(sender, setting, value, **kwargs):` |
| `template_rendered` | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —à–∞–±–ª–æ–Ω–∞ –≤ —Ç–µ—Å—Ç–∞—Ö. | `sender`: –û–±—ä–µ–∫—Ç `Template`.<br>`template`: –¢–æ –∂–µ, —á—Ç–æ –∏ `sender`.<br>`context`: –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞. | `def h(sender, template, context, **kwargs):` |

>[!highlight]
>
>#### –ö–ª—é—á–µ–≤—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
>
>–ù–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –≤—ã –±—É–¥–µ—Ç–µ –≤—Å—Ç—Ä–µ—á–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã:
>
>- `sender`: –ö–ª–∞—Å—Å, –æ—Ç–ø—Ä–∞–≤–∏–≤—à–∏–π —Å–∏–≥–Ω–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏).
>- `instance`: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –æ–±—ä–µ–∫—Ç–∞, —Å –∫–æ—Ç–æ—Ä—ã–º —Å–≤—è–∑–∞–Ω–æ —Å–æ–±—ã—Ç–∏–µ.
>- `created`: –ë—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è `post_save`), `True` –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω, `False` –µ—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω.
>- `action`: –°—Ç—Ä–æ–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è `m2m_changed`), –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è –¥–µ–π—Å—Ç–≤–∏–µ: `pre_add`, `post_add`, `pre_remove`, `post_remove`, `pre_clear`, `post_clear`.

–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –¥–∞–µ—Ç –æ–±—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç —Å–∏–≥–Ω–∞–ª—ã. –í —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∏—Ö –∫ —ç—Ç–∏–º —Å–∏–≥–Ω–∞–ª–∞–º –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á.

## –°–∏–≥–Ω–∞–ª –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤

### –ú–æ–¥–µ–ª—å `Review`: –æ—Å–Ω–æ–≤–∞ –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤ üìù

–ß—Ç–æ–±—ã –Ω–∞—à –º–µ—Ö–∞–Ω–∏–∑–º –º–æ–¥–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–ª, –Ω–∞–º –Ω—É–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –º–æ–¥–µ–ª—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ —ç—Ç—É —Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–æ–¥–µ–ª—å `Review` –∏–∑ —Ñ–∞–π–ª–∞ [`core/models.py`](core/models.py:89). –û–Ω–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Å—Ç–∞–≤–ª—è—é—Ç –æ —Ä–∞–±–æ—Ç–µ –º–∞—Å—Ç–µ—Ä–æ–≤. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ–µ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è.

```python
# core/models.py

class Review(models.Model):
    RATING_CHOICES = [
        (1, "–£–∂–∞—Å–Ω–æ"),
        (2, "–ü–ª–æ—Ö–æ"),
        (3, "–ù–æ—Ä–º–∞–ª—å–Ω–æ"),
        (4, "–•–æ—Ä–æ—à–æ"),
        (5, "–û—Ç–ª–∏—á–Ω–æ"),
    ]

    STATUS_CHOICES = [
        ("new", "–ù–æ–≤—ã–π"),
        ("ai_moderating", "–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏"),
        ("ai_approved", "–û–¥–æ–±—Ä–µ–Ω –ò–ò"),
        ("ai_rejected", "–û—Ç–∫–ª–æ–Ω–µ–Ω –ò–ò"),
        ("published", "–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω"),
        ("archived", "–í –∞—Ä—Ö–∏–≤–µ"),
    ]

    text = models.TextField(verbose_name="–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞")
    rating = models.PositiveSmallIntegerField(
        choices=RATING_CHOICES, verbose_name="–†–µ–π—Ç–∏–Ω–≥", default=5
    )
    status = models.CharField(
        max_length=20, choices=STATUS_CHOICES, default="new", verbose_name="–°—Ç–∞—Ç—É—Å")
    # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è ...
```

–ö–∞–∫ –≤–∏–¥–∏—Ç–µ, –º–æ–¥–µ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –æ—Ç–∑—ã–≤–∞: `text` –¥–ª—è —Å–∞–º–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ `rating` –¥–ª—è –æ—Ü–µ–Ω–∫–∏. –û–¥–Ω–∞–∫–æ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –¥–ª—è –Ω–∞—Å –ø–æ–ª–µ ‚Äî —ç—Ç–æ `status`.

>[!highlight]
>#### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ—Ç–∑—ã–≤–∞
>–ü–æ–ª–µ `status` –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏. –û–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ: –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è (`new`) –¥–æ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (`published`) –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è. –ò–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ–ª—è –±—É–¥–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –≤ —Ä–∞–±–æ—Ç–µ –Ω–∞—à–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞. –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ ‚Äî `"new"`, —á—Ç–æ –∏ –±—É–¥–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä–æ–º –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏.

–≠—Ç–∞ –º–æ–¥–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º—ã –ø–æ—Å—Ç—Ä–æ–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –º–æ–¥–µ—Ä–∞—Ü–∏–∏. –í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –±—É–¥–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞.

### AI-–º–æ–¥–µ—Ä–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é Mistral üß†

–°–µ—Ä–¥—Ü–µ–º –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `is_bad_review` –≤ —Ñ–∞–π–ª–µ [`core/mistral.py`](core/mistral.py:1). –ï—ë –∑–∞–¥–∞—á–∞ ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞ –Ω–∞ –∞–Ω–∞–ª–∏–∑ –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç—å Mistral –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Ç–∑—ã–≤ "–ø–ª–æ—Ö–∏–º" (—Ç–æ–∫—Å–∏—á–Ω—ã–º, –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω—ã–º –∏ —Ç.–¥.).

```python
# core/mistral.py

from barbershop.settings import MISTRAL_MODERATIONS_GRADES, MISTRAL_API_KEY
from mistralai import Mistral
import time

def is_bad_review(review_text: str, api_key: str= MISTRAL_API_KEY, grades:dict =MISTRAL_MODERATIONS_GRADES) -> bool:
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞ Mistral
    client = Mistral(api_key=api_key)

    # –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –º–æ–¥–µ—Ä–∞—Ü–∏–∏
    response = client.classifiers.moderate_chat(
        model="mistral-moderation-latest",
        inputs=[{"role": "user", "content": review_text}],
    )
    # –í—ã—Ç–∞—Å–∫–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –æ—Ü–µ–Ω–∫–æ–π
    result = response.results[0].category_scores

    # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ...

    # –ï—Å–ª–∏ –æ–¥–Ω–æ –∏–∑ –∑–Ω–∞—á–µ–Ω–∏–π True, —Ç–æ –æ—Ç–∑—ã–≤ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –º–æ–¥–µ—Ä–∞—Ü–∏—é
    return any(checked_result.values())
```

–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∞—è:
1.  **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞**: –°–æ–∑–¥–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API Mistral —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–ª—é—á–∞ `MISTRAL_API_KEY` –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
2.  **–ó–∞–ø—Ä–æ—Å –∫ API**: –¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞ (`review_text`) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç `mistral-moderation-latest`.
3.  **–ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫**: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å `category_scores`, –≥–¥–µ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏" (–Ω–∞–ø—Ä–∏–º–µ—Ä, `hate`, `spam`, `insult`) –ø—Ä–∏—Å–≤–æ–µ–Ω–∞ –æ—Ü–µ–Ω–∫–∞ –æ—Ç 0 –¥–æ 1.
4.  **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ—Ä–æ–≥–∞–º–∏**: –≠—Ç–∏ –æ—Ü–µ–Ω–∫–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å–æ —Å–ª–æ–≤–∞—Ä–µ–º `MISTRAL_MODERATIONS_GRADES` –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞. –í —ç—Ç–æ–º —Å–ª–æ–≤–∞—Ä–µ –∑–∞–¥–∞–Ω—ã –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
5.  **–í–µ—Ä–¥–∏–∫—Ç**: –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∏–∑ –æ—Ü–µ–Ω–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ä–æ–≥, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True`, –ø–æ–º–µ—á–∞—è –æ—Ç–∑—ã–≤ –∫–∞–∫ "–ø–ª–æ—Ö–æ–π". –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `False`.

>[!info]
>#### –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤
>
>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è `MISTRAL_MODERATIONS_GRADES` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Django (`settings.py`) –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –º–æ–¥–µ—Ä–∞—Ü–∏–∏. –ú—ã –º–æ–∂–µ–º –∏–∑–º–µ–Ω—è—Ç—å –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–µ —Ç—Ä–æ–≥–∞—è –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥, —á—Ç–æ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –º–æ–¥–µ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏, –æ—Å—Ç–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å –∏—Ö –≤–º–µ—Å—Ç–µ. –ò –¥–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç —Å–∏–≥–Ω–∞–ª—ã Django, –æ —á–µ–º –º—ã –∏ –ø–æ–≥–æ–≤–æ—Ä–∏–º –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏.

### –°–≤—è–∑—É—é—â–µ–µ –∑–≤–µ–Ω–æ: —Å–∏–≥–Ω–∞–ª `post_save` üîó

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –º–æ–¥–µ–ª—å –∏ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω–∞–º –Ω—É–∂–Ω–æ –∏—Ö "–ø–æ–∂–µ–Ω–∏—Ç—å". –î–ª—è —ç—Ç–æ–≥–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª `post_save`, –∫–æ—Ç–æ—Ä—ã–π Django –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ù–∞—à –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —ç—Ç–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ [`core/signals.py`](core/signals.py:1).

```python
# core/signals.py
from django.db.models.signals import post_save
from django.dispatch import receiver
from .models import Review
from .mistral import is_bad_review


@receiver(post_save, sender=Review)
def ai_validate_process_review(sender, instance, created, **kwargs):
    # –ë—ã–ª–∞ –ª–∏ —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å
    if created and not kwargs.get('raw', False):
        # –ú–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å "–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏"
        instance.status = "ai_moderating"

        # –ó–∞–ø—É—Å–∫–∞–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ AI
        try:
            is_bad = is_bad_review(instance.text)
            if is_bad:
                instance.status = "ai_rejected"
            else:
                instance.status = "ai_approved"

        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ—Ç–∑—ã–≤–∞: {e}")

        finally:
            instance.save()
```

–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º, —á—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

1.  **–î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@receiver`**: –≠—Ç–æ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä "–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç" –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é `ai_validate_process_review` –Ω–∞ —Å–∏–≥–Ω–∞–ª `post_save`. –í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç: –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º `sender=Review`, —á—Ç–æ–±—ã —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏ `Review` –∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ.
2.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ `created`**: –í–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –º—ã –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥ `created`. –û–Ω —Ä–∞–≤–µ–Ω `True` —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ **–Ω–æ–≤–∞—è** –∑–∞–ø–∏—Å—å. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∑–∞–ø—É—Å–∫–∞—Ç—å –º–æ–¥–µ—Ä–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, –∞ –Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏.
3.  **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞**: –ö–∞–∫ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–π –æ—Ç–∑—ã–≤ —Å–æ–∑–¥–∞–Ω, –º—ã –º–µ–Ω—è–µ–º –µ–≥–æ —Å—Ç–∞—Ç—É—Å –Ω–∞ `"ai_moderating"`.
4.  **–í—ã–∑–æ–≤ –º–æ–¥–µ—Ä–∞—Ü–∏–∏**: –ó–∞—Ç–µ–º –º—ã –≤—ã–∑—ã–≤–∞–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é `is_bad_review`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–π —Ç–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞ (`instance.text`).
5.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É**: –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –≤–µ—Ä–Ω—É–ª–∞ —Ñ—É–Ω–∫—Ü–∏—è (`True` –∏–ª–∏ `False`), –º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å: `"ai_rejected"` (–æ—Ç–∫–ª–æ–Ω–µ–Ω) –∏–ª–∏ `"ai_approved"` (–æ–¥–æ–±—Ä–µ–Ω).
6.  **–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –í –±–ª–æ–∫–µ `finally` –º—ã —Å–Ω–æ–≤–∞ –≤—ã–∑—ã–≤–∞–µ–º `instance.save()`, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

>[!info]
>#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
>–ß—Ç–æ–±—ã Django —É–∑–Ω–∞–ª –æ –Ω–∞—à–µ–º —Ñ–∞–π–ª–µ `signals.py` –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –≤ –Ω–µ–º, –µ–≥–æ –Ω—É–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –º–µ—Ç–æ–¥–µ `ready()` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ [`core/apps.py`](core/apps.py:1). –ë–µ–∑ —ç—Ç–æ–≥–æ —à–∞–≥–∞ –º–∞–≥–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç!

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã —Å–æ–∑–¥–∞–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–∑—ã–≤, Django —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ, `post_save` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª, –Ω–∞—à –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç AI-–ø—Ä–æ–≤–µ—Ä–∫—É –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å.

### –ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã –Ω–∞—à–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ ü§î

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ `post_save` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ AI-–º–æ–¥–µ—Ä–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ –∏ –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –Ω–æ, –∫–∞–∫ –∏ –ª—é–±–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –≤—ã–±–æ—Ä, –æ–Ω–æ –∏–º–µ–µ—Ç —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ –∏ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ (‚úÖ):**

*   **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ (Decoupling)**: –ì–ª–∞–≤–Ω—ã–π –ø–ª—é—Å ‚Äî –º—ã –Ω–µ "–∑–∞—Å–æ—Ä—è–µ–º" –∫–æ–¥ –º–æ–¥–µ–ª–∏ `Review` –∏–ª–∏ `view`-—Ñ—É–Ω–∫—Ü–∏–∏ –ª–æ–≥–∏–∫–æ–π, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω–æ–π –Ω–∞–ø—Ä—è–º—É—é —Å –∏—Ö –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏. –ú–æ–¥–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –¥–∞–Ω–Ω—ã–µ, `view` ‚Äî –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–∞, –∞ —Å–∏–≥–Ω–∞–ª ‚Äî –∑–∞ —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ —Å–æ–±—ã—Ç–∏–µ. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ —á–∏—â–µ –∏ –ø—Ä–æ—â–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ.
*   **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É), –º—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ç–æ–≥–æ –∂–µ —Å–∏–≥–Ω–∞–ª–∞, –Ω–µ –º–µ–Ω—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥.
*   **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è**: –í—Å—è –ª–æ–≥–∏–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å —Ä–µ–∞–∫—Ü–∏–µ–π –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ ‚Äî –≤ —Ñ–∞–π–ª–µ `signals.py`. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –µ–µ –ø–æ–∏—Å–∫ –∏ –æ—Ç–ª–∞–¥–∫—É.

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ (‚ùå):**

*   **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**: –ö–∞–∫ –º—ã —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏, —Å–∏–≥–Ω–∞–ª—ã –≤ Django –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –æ—Ç–ø—Ä–∞–≤–∏–≤—à–∏–π –æ—Ç–∑—ã–≤, –±—É–¥–µ—Ç –∂–¥–∞—Ç—å, –ø–æ–∫–∞ `is_bad_review` –∑–∞–≤–µ—Ä—à–∏—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É. –ê —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–µ–ª–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ç–µ–≤–æ–π –∑–∞–ø—Ä–æ—Å –∫ API Mistral, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º. –í –∫–æ–¥–µ –¥–∞–∂–µ –µ—Å—Ç—å `time.sleep(10)`, –∫–æ—Ç–æ—Ä—ã–π –∏–º–∏—Ç–∏—Ä—É–µ—Ç —ç—Ç—É –∑–∞–¥–µ—Ä–∂–∫—É. –≠—Ç–æ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç (UX), –∑–∞—Å—Ç–∞–≤–ª—è—è –µ–≥–æ –∂–¥–∞—Ç—å.
*   **–°–∫—Ä—ã—Ç–∞—è –ª–æ–≥–∏–∫–∞**: –î–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è `Review` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫–æ–π-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –õ–æ–≥–∏–∫–∞ –Ω–µ –≤–∏–¥–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é –≤ `models.py` –∏–ª–∏ `views.py`, –∏ –µ–µ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ –∑–Ω–∞—Ç—å –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ `signals.py`.
*   **–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏**: –ï—Å–ª–∏ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Å–∏–≥–Ω–∞–ª–∞ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞, –µ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–µ–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å, —á–µ–º –æ—à–∏–±–∫—É –≤ –ª–∏–Ω–µ–π–Ω–æ–º –∫–æ–¥–µ `view`-—Ñ—É–Ω–∫—Ü–∏–∏.

>[!warning]
>#### –†–∏—Å–∫ –¥–æ–ª–≥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
>
>–û—Å–Ω–æ–≤–Ω–æ–π –º–∏–Ω—É—Å –Ω–∞—à–µ–≥–æ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è ‚Äî —ç—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ API Mistral –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –¥–æ–ª–≥–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å, —á—Ç–æ —Å–∞–π—Ç "–∑–∞–≤–∏—Å", –∏ —É–π—Ç–∏.

–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –Ω–∞–≥–ª—è–¥–Ω–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É —á–∏—Å—Ç–æ—Ç–æ–π –∫–æ–¥–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é. –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∏ –±—ã—Å—Ç—Ä—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–∏–≥–Ω–∞–ª—ã –ø–æ–¥—Ö–æ–¥—è—Ç –æ—Ç–ª–∏—á–Ω–æ, –Ω–æ –¥–ª—è –¥–æ–ª–≥–∏—Ö –∑–∞–¥–∞—á –æ–Ω–∏ –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å "–±—É—Ç—ã–ª–æ—á–Ω—ã–º –≥–æ—Ä–ª—ã—à–∫–æ–º".
### –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ üöÄ

–ü—Ä–æ–±–ª–µ–º–∞ —Å "–∑–∞–≤–∏—Å–∞–Ω–∏–µ–º" –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–∑-–∑–∞ –¥–æ–ª–≥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –æ—Ç API ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –†–µ—à–µ–Ω–∏–µ ‚Äî –≤—ã–Ω–µ—Å—Ç–∏ –¥–æ–ª–≥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —Ñ–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞. –î–ª—è —ç—Ç–æ–≥–æ –≤ Django-–º–∏—Ä–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Å–∏—Å—Ç–µ–º—ã –æ—á–µ—Ä–µ–¥–µ–π –∑–∞–¥–∞—á.

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á?**

-   **–î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª—å—à–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ—Ç–µ–Ω –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –≤–Ω–µ—à–Ω–∏–º API, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤, —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–∫–∞ email), –µ–µ —Å–ª–µ–¥—É–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π.
-   **–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞**: –ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤–µ–ª–∏–∫–æ, —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –±—ã—Å—Ç—Ä–æ –∏—Å—á–µ—Ä–ø–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã —Å–µ—Ä–≤–µ—Ä–∞. –û—á–µ—Ä–µ–¥–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ –º–µ—Ä–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤.
-   **–ü–æ–≤—ã—à–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏**: –ï—Å–ª–∏ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Å–±–æ–π, –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –æ—à–∏–±–∫—É. –í –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ö–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å –æ—á–µ—Ä–µ–¥—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, Django Q2 –∏–ª–∏ Celery)?**

1.  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–∑—ã–≤.
2.  `view`-—Ñ—É–Ω–∫—Ü–∏—è –∏–ª–∏ —Å–∏–≥–Ω–∞–ª `post_save` **–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç** `is_bad_review` –Ω–∞–ø—Ä—è–º—É—é.
3.  –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–Ω —Å–æ–∑–¥–∞–µ—Ç **–∑–∞–¥–∞—á—É** –∏ —Å—Ç–∞–≤–∏—Ç –µ–µ –≤ –æ—á–µ—Ä–µ–¥—å. –ù–∞–ø—Ä–∏–º–µ—Ä: `async_task('core.mistral.is_bad_review', review_id)`.
4.  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç "–°–ø–∞—Å–∏–±–æ, –≤–∞—à –æ—Ç–∑—ã–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é!".
5.  –í –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ (worker) –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á –∑–∞–±–∏—Ä–∞–µ—Ç –Ω–∞—à—É –∑–∞–¥–∞—á—É –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `is_bad_review`.
6.  –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è worker –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –æ—Ç–∑—ã–≤–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

>[!highlight]
>#### –°–∏–≥–Ω–∞–ª –∫–∞–∫ —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏
>
>–°–∏–≥–Ω–∞–ª—ã –∏ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á –Ω–µ –∏—Å–∫–ª—é—á–∞—é—Ç, –∞ –¥–æ–ø–æ–ª–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞. –°–∏–≥–Ω–∞–ª `post_save` –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –∏–¥–µ–∞–ª—å–Ω—ã–º **—Ç—Ä–∏–≥–≥–µ—Ä–æ–º**, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥—å. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º "—Ä–∞–∑–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å" –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –Ω–æ –∏–∑–±–∞–≤–ª—è–µ–º—Å—è –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

–ü–µ—Ä–µ—Ö–æ–¥ –∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –æ—á–µ—Ä–µ–¥—è–º ‚Äî —ç—Ç–æ –ª–æ–≥–∏—á–Ω—ã–π —ç—Ç–∞–ø —ç–≤–æ–ª—é—Ü–∏–∏ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∏ —É–ª—É—á—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –º–µ–¥–ª–µ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.