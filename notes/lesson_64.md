# –£—Ä–æ–∫ 62: –ú–∞–≥–∏—è Django Class-Based Views (CBV)

Django Class-Based Views (CBV) ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –∫–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–µ–±-–∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ Function-Based Views (FBV). –û–Ω–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –Ω–∞–±–æ—Ä –≥–æ—Ç–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ —É–ª—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.

```mermaid
flowchart LR
    %% –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
    View["üèõÔ∏è View<br/><small>–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –≤—Å–µ—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π</small>"]
    TemplateView["üé® TemplateView<br/><small>–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞</small>"]
    RedirectView["üîÑ RedirectView<br/><small>–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</small>"]
    
    %% Generic Views
    GenericView["‚öôÔ∏è GenericView<br/><small>–ë–∞–∑–æ–≤—ã–π Generic View</small>"]
    
    %% Display Views
    DetailView["üîç DetailView<br/><small>–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ–±—ä–µ–∫—Ç–∞</small>"]
    ListView["üìã ListView<br/><small>–°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤</small>"]
    
    %% Edit Views
    FormView["üìù FormView<br/><small>–†–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–∞–º–∏</small>"]
    CreateView["‚ûï CreateView<br/><small>–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞</small>"]
    UpdateView["‚úèÔ∏è UpdateView<br/><small>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞</small>"]
    DeleteView["üóëÔ∏è DeleteView<br/><small>–£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞</small>"]
    
    %% Date Views
    ArchiveIndexView["üìÖ ArchiveIndexView<br/><small>–ê—Ä—Ö–∏–≤–Ω—ã–π –∏–Ω–¥–µ–∫—Å</small>"]
    YearArchiveView["üìÜ YearArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –≥–æ–¥–∞–º</small>"]
    MonthArchiveView["üóìÔ∏è MonthArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –º–µ—Å—è—Ü–∞–º</small>"]
    WeekArchiveView["üìä WeekArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –Ω–µ–¥–µ–ª—è–º</small>"]
    DayArchiveView["üìã DayArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –¥–Ω—è–º</small>"]
    TodayArchiveView["‚è∞ TodayArchiveView<br/><small>–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –∞—Ä—Ö–∏–≤</small>"]
    DateDetailView["üîç DateDetailView<br/><small>–î–µ—Ç–∞–ª–∏ –ø–æ –¥–∞—Ç–µ</small>"]
    
    %% –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
    View --> TemplateView
    View --> RedirectView
    View --> GenericView
    
    GenericView --> DetailView
    GenericView --> ListView
    GenericView --> FormView
    
    FormView --> CreateView
    FormView --> UpdateView
    FormView --> DeleteView
    
    ListView --> ArchiveIndexView
    ListView --> YearArchiveView
    ListView --> MonthArchiveView
    ListView --> WeekArchiveView
    ListView --> DayArchiveView
    ListView --> TodayArchiveView
    
    DetailView --> DateDetailView
    
    %% –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
    classDef baseClass fill:#e1f5fe,stroke:#01579b,stroke-width:3px,color:#000
    classDef templateClass fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    classDef listClass fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px,color:#000
    classDef formClass fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
    classDef dateClass fill:#fce4ec,stroke:#880e4f,stroke-width:2px,color:#000
    
    class View baseClass
    class TemplateView,RedirectView templateClass
    class GenericView,DetailView,ListView listClass
    class FormView,CreateView,UpdateView,DeleteView formClass
    class ArchiveIndexView,YearArchiveView,MonthArchiveView,WeekArchiveView,DayArchiveView,TodayArchiveView,DateDetailView dateClass
```

> **–ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫ –¥–∏–∞–≥—Ä–∞–º–º–µ:**
>
> * **`View`**: –°–∞–º—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å. –û—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–µ—Ç–æ–¥–∞–º (`get`, `post` –∏ —Ç.–¥.).
> * **Mixins**: –ö–ª–∞—Å—Å—ã-–ø—Ä–∏–º–µ—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–±–∞–≤–ª—è—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.
>   * `TemplateResponseMixin`: –î–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —à–∞–±–ª–æ–Ω–æ–≤.
>   * `ContextMixin`: –î–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö (–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞) –≤ —à–∞–±–ª–æ–Ω.
>   * `SingleObjectMixin`: –î–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –º–æ–¥–µ–ª–∏ (`.get()`).
>   * `MultipleObjectMixin`: –î–æ–±–∞–≤–ª—èa–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (`.all()`, `.filter()`).
> * **Generic Views**: –ì–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–ª–∞—Å—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç `View` –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–∏–∫—Å–∏–Ω—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á (–ø–æ–∫–∞–∑ —à–∞–±–ª–æ–Ω–∞, –æ–±—ä–µ–∫—Ç–∞, —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤).

## 1. –ë–∞–∑–æ–≤–∞—è View (`django.views.View`)

–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `View` —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –≤—Å–µ—Ö Class-Based Views –≤ Django. –û–Ω –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –∫—Ä–æ–º–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏–∏ HTTP-–º–µ—Ç–æ–¥–æ–≤. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥—ã —Å –∏–º–µ–Ω–∞–º–∏ HTTP-–≥–ª–∞–≥–æ–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `get()`, `post()`, `put()`, `delete()`), –∏ Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑–æ–≤–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

### –ú–µ—Ç–æ–¥—ã

* **`get(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ GET-–∑–∞–ø—Ä–æ—Å–∞.
* **`post(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ POST-–∑–∞–ø—Ä–æ—Å–∞.
* **`put(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ PUT-–∑–∞–ø—Ä–æ—Å–∞.
* **`delete(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ DELETE-–∑–∞–ø—Ä–æ—Å–∞.
* **`dispatch(self, request, *args, **kwargs)`**: –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å. –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø HTTP-–º–µ—Ç–æ–¥–∞ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ (`get`, `post` –∏ —Ç.–¥.). –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `dispatch` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç HTTP-–º–µ—Ç–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π).

### Args –∏ kwargs

`*args` –∏ `**kwargs` –≤ –º–µ—Ç–æ–¥–∞—Ö CBV (`get`, `post` –∏ —Ç.–¥.) –ø–æ–ª—É—á–∞—é—Ç —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –≤ URL-—à–∞–±–ª–æ–Ω–µ (`urls.py`). –í –ø–æ–¥–∞–≤–ª—è—é—â–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –≤—ã –±—É–¥–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å `**kwargs`, —Ç–∞–∫ –∫–∞–∫ Django –ø–µ—Ä–µ–¥–∞–µ—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∫ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.

–í–æ—Ç —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `**kwargs`:

| –ê—Ä–≥—É–º–µ–Ω—Ç | –û—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä URL-—à–∞–±–ª–æ–Ω–∞ | –ü—Ä–∏–º–µ—Ä `kwargs` –≤ View |
| :--- | :--- | :--- | :--- | :--- |
| `pk` | –ò–∑ URL | **P**rimary **K**ey (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á) –æ–±—ä–µ–∫—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ `DetailView` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –≤ –ë–î. | `path('item/<int:pk>/', ...)` | `{'pk': 123}` |
| `slug` | –ò–∑ URL | "–°–ª–∞–≥" –æ–±—ä–µ–∫—Ç–∞ ‚Äî —á–µ–ª–æ–≤–µ–∫–æ-–ø–æ–Ω—è—Ç–Ω–∞—è —á–∞—Å—Ç—å URL. –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `DetailView` –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ `pk`. | `path('post/<slug:slug>/', ...)` | `{'slug': 'my-first-post'}` |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | –ò–∑ URL | –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –≤ —Å–≤–æ–µ–º URL-—à–∞–±–ª–æ–Ω–µ. | `path('archive/<int:year>/<str:month>/', ...)` | `{'year': 2024, 'month': 'july'}` |

`*args` (–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ —Ä–µ–∂–µ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ URL-—à–∞–±–ª–æ–Ω–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–º–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø. –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ Django ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

### –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞?

–ë–∞–∑–æ–≤–∞—è `View` –ø–æ–ª–µ–∑–Ω–∞, –∫–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤, –∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ CBV. –û–Ω–∞ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:

* –°–æ–∑–¥–∞–Ω–∏—è API-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤, –≥–¥–µ –ª–æ–≥–∏–∫–∞ —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç HTTP-–º–µ—Ç–æ–¥–∞.
* –û–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–æ—Ä–º, —Ç—Ä–µ–±—É—é—â–∏—Ö —Ä–∞–∑–ª–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è GET –∏ POST.
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º `GreetingView`:

```python
# core/views.py
from django.views import View
from django.http import HttpResponse

class GreetingView(View):
    """
    –ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ View.
    –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É GET –∏ POST –∑–∞–ø—Ä–æ—Å–æ–≤.
    """
    greeting_get_message = "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –≠—Ç–æ GET –∑–∞–ø—Ä–æ—Å –∏–∑ GreetingView."
    greeting_post_message = "–í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ POST –∑–∞–ø—Ä–æ—Å –≤ GreetingView!"

    def get(self, request, *args, **kwargs):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç GET-–∑–∞–ø—Ä–æ—Å—ã.
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ HTTP-—Å–æ–æ–±—â–µ–Ω–∏–µ.
        """
        return HttpResponse(self.greeting_get_message)

    def post(self, request, *args, **kwargs):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç POST-–∑–∞–ø—Ä–æ—Å—ã.
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ HTTP-—Å–æ–æ–±—â–µ–Ω–∏–µ.
        """
        return HttpResponse(self.greeting_post_message)
```

> [!info]
> #### –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω? ü§î
> –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `View` –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã. –ï—Å–ª–∏ –Ω–∞ URL, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å `GreetingView`, –ø—Ä–∏–¥–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, `PUT` –∏–ª–∏ `PATCH` –∑–∞–ø—Ä–æ—Å, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Ç–æ–¥—ã –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã, Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É **`405 Method Not Allowed`**. –≠—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —Ä–∞–∑—Ä–µ—à–∞—è —Ç–æ–ª—å–∫–æ —è–≤–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ HTTP-–º–µ—Ç–æ–¥—ã.

–í `core/urls.py` —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ —Ç–∞–∫:

```python
# core/urls.py
from django.urls import path
from .views import GreetingView

urlpatterns = [
    path("greeting/", GreetingView.as_view(), name="greeting"),
]
```

–ú–µ—Ç–æ–¥ `.as_view()` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –≤—ã–∑—ã–≤–∞–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é Django –æ–∂–∏–¥–∞–µ—Ç –¥–ª—è URL-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.

### –°–ª—É–∂–µ–±–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã ‚öôÔ∏è

–ü–æ–º–∏–º–æ –º–µ—Ç–æ–¥–æ–≤, —É –±–∞–∑–æ–≤–æ–π `View` –µ—Å—Ç—å –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

> [!highlight]
> #### –ê—Ç—Ä–∏–±—É—Ç `http_method_names`
> * **`http_method_names`**: –≠—Ç–æ –∞—Ç—Ä–∏–±—É—Ç **–∫–ª–∞—Å—Å–∞**, —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π, –∫–∞–∫–∏–µ HTTP-–º–µ—Ç–æ–¥—ã –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –≤–∫–ª—é—á–∞–µ—Ç `['get', 'post', 'put', 'patch', 'delete', 'head', 'options', 'trace']`. –í—ã –º–æ–∂–µ—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—á–∞–ª–æ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –≤–∞—à–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–æ —Ç–æ–ª—å–∫–æ `GET` –∏ `POST` –∑–∞–ø—Ä–æ—Å—ã, –≤—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `http_method_names = ['get', 'post', 'head', 'options']`. –õ—é–±–æ–π –¥—Ä—É–≥–æ–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–∏—Ç –æ—à–∏–±–∫—É `405 Method Not Allowed`.

> [!info]
> #### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
> –ü–æ–º–∏–º–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∑–∞–¥–∞–µ–º –∑–∞—Ä–∞–Ω–µ–µ, –º–µ—Ç–æ–¥ `dispatch` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (`self`) –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–∑–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ –ª—é–±–æ–º –º–µ—Ç–æ–¥–µ (`get`, `post` –∏ —Ç.–¥.):
> * **`self.request`**: –ü–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç `HttpRequest`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –∑–∞–ø—Ä–æ—Å–µ (–∑–∞–≥–æ–ª–æ–≤–∫–∏, `GET`/`POST` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `request.user` –∏ —Ç.–¥.). –≠—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ.
> * **`self.args`**: –ö–æ—Ä—Ç–µ–∂ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –∏–∑ URL. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ.
> * **`self.kwargs`**: –°–ª–æ–≤–∞—Ä—å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –∏–∑ URL (–Ω–∞–ø—Ä–∏–º–µ—Ä, `pk` –∏–ª–∏ `slug`). –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ URL –≤ CBV.

### PK –∏ SLUG üéØ

–ö–∞–∫ –º—ã —É–∂–µ –≤–∏–¥–µ–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—ã—à–µ, Django –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏ URL —Å –ø–æ–º–æ—â—å—é —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã—Ö **–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–æ–≤ –ø—É—Ç–µ–π** (path converters), —Ç–∞–∫–∏—Ö –∫–∞–∫ `<int:pk>` –∏ `<slug:slug>`. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞—é—Ç –≤ –Ω–∞—à–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏ –∫–∞–∫ —Å –Ω–∏–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å.

#### –ú–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ URL –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤:

1.  **URL-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä**: –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç URL –≤—Ä–æ–¥–µ `/item/123/`, Django –Ω–∞—Ö–æ–¥–∏—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —à–∞–±–ª–æ–Ω –≤ `urls.py`, –Ω–∞–ø—Ä–∏–º–µ—Ä, `path('item/<int:pk>/', ...)`.
2.  **–ó–∞—Ö–≤–∞—Ç –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è**: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä `<int:pk>` "–ø–æ–Ω–∏–º–∞–µ—Ç", —á—Ç–æ `123` ‚Äî —ç—Ç–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ, —Å–æ–∑–¥–∞–≤–∞—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç `pk` —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `123`.
3.  **–í—ã–∑–æ–≤ `dispatch`**: URL-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ `.as_view()`, –∫–æ—Ç–æ—Ä—ã–π, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, —Å–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –≤–∞—à–µ–≥–æ View –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –µ–≥–æ –º–µ—Ç–æ–¥ `dispatch`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–º—É –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–∞–∫ `**kwargs`. –¢–æ –µ—Å—Ç—å, `dispatch(request, pk=123)`.
4.  **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ**: –í–Ω—É—Ç—Ä–∏ –±–∞–∑–æ–≤–æ–≥–æ `View` –º–µ—Ç–æ–¥ `dispatch` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –∞—Ç—Ä–∏–±—É—Ç–∞—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞: `self.request`, `self.args` –∏ `self.kwargs`.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤–Ω—É—Ç—Ä–∏ –ª—é–±–æ–≥–æ –º–µ—Ç–æ–¥–∞ –≤–∞—à–µ–≥–æ CBV (–±—É–¥—å —Ç–æ `get`, `post` –∏–ª–∏ –¥–∞–∂–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π `dispatch`) –≤—ã –º–æ–∂–µ—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏–∑ URL —á–µ—Ä–µ–∑ —Å–ª–æ–≤–∞—Ä—å `self.kwargs`.

#### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ View?

–°–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å `pk` –∏–ª–∏ `slug` –≤–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ ‚Äî —ç—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–ª–æ–≤–∞—Ä—é `self.kwargs`.

```python
# core/views.py (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä)
from django.views import View
from django.http import HttpResponse
from .models import Master # –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –º–æ–¥–µ–ª—å Master

class MasterDetailView(View):
    def get(self, request, *args, **kwargs):
        # –ü–æ–ª—É—á–∞–µ–º pk –∏–∑ self.kwargs, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ dispatch()
        master_id = self.kwargs.get('pk')

        if not master_id:
            return HttpResponse("ID –º–∞—Å—Ç–µ—Ä–∞ –Ω–µ —É–∫–∞–∑–∞–Ω.", status=400)

        try:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º pk –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            master = Master.objects.get(pk=master_id)
            return HttpResponse(f"–í—ã –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç–µ –º–∞—Å—Ç–µ—Ä–∞: {master.first_name} {master.last_name} (ID: {master_id})")
        except Master.DoesNotExist:
            return HttpResponse(f"–ú–∞—Å—Ç–µ—Ä —Å ID {master_id} –Ω–µ –Ω–∞–π–¥–µ–Ω.", status=404)

```

–ò —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import MasterDetailView

urlpatterns = [
    # ...
    path("master/<int:pk>/", MasterDetailView.as_view(), name="master_detail_view"),
]
```

> [!warning]
> #### `kwargs` –≤ –º–µ—Ç–æ–¥–µ vs `self.kwargs`
> –•–æ—Ç—è –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º URL –∏ —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç `kwargs` –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –º–µ—Ç–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `def get(self, request, *args, **kwargs):`), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `self.kwargs` —Å—á–∏—Ç–∞–µ—Ç—Å—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ `self.kwargs` –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥–æ–º `dispatch` –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º.

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ `DetailView`, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É—é—Ç —ç—Ç—É –ª–æ–≥–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –ø–æ `pk` –∏–ª–∏ `slug` –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è.

## 2. TemplateView (`django.views.generic.TemplateView`)

`TemplateView` ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CBV, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è –∑–∞–º–µ–Ω–∞ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö Function-Based Views, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å—Ç–æ —Ä–µ–Ω–¥–µ—Ä—è—Ç —à–∞–±–ª–æ–Ω.

### –ê—Ç—Ä–∏–±—É—Ç—ã

* **`template_name`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –∏–º—è —à–∞–±–ª–æ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω.
* **`extra_context`**: –°–ª–æ–≤–∞—Ä—å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞.

### –†–∞—Å—à–∏—Ä—è–µ–º—ã–µ –º–µ—Ç–æ–¥—ã

* **`get_context_data(self, **kwargs)`**: –ú–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —à–∞–±–ª–æ–Ω. –û–Ω –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å. –í–∞–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å `super().get_context_data(**kwargs)`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞.
* **`get_template_names(self)`**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏–º—è —à–∞–±–ª–æ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–∏–∫–∏. –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `template_name`.
* **`dispatch(self, request, *args, **kwargs)`**: –ö–∞–∫ –∏ –≤ –±–∞–∑–æ–≤–æ–π `View`, –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –¥–æ –≤—ã–∑–æ–≤–∞ `get()` (–∏–ª–∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–æ–≤ HTTP).

### –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞?

* –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü "–û –Ω–∞—Å", "–ö–æ–Ω—Ç–∞–∫—Ç—ã", "–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏" –∏ –¥—Ä—É–≥–∏—Ö —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.
* –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü, –≥–¥–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Å—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î.

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

#### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π `TemplateView` (`SimplePageView`)

```python
# core/views.py
from django.views.generic import TemplateView

class SimplePageView(TemplateView):
    """
    –ü—Ä–æ—Å—Ç–µ–π—à–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ç—Ä–∏–±—É—Ç template_name –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–∞.
    """
    template_name = "core/simple_page.html"
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import SimplePageView

urlpatterns = [
    path("simple-page/", SimplePageView.as_view(), name="simple_page"),
]
```

–≠—Ç–æ "View –≤ 2 —Å—Ç—Ä–æ–∫–∏", —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ, —á—Ç–æ –Ω—É–∂–Ω–æ, —ç—Ç–æ —É–∫–∞–∑–∞—Ç—å –∏–º—è —à–∞–±–ª–æ–Ω–∞.

#### –ü—Ä–∏–º–µ—Ä 2: `TemplateView` —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (`AboutUsView`)

```python
# core/views.py
from django.views.generic import TemplateView
import datetime # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º datetime –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

class AboutUsView(TemplateView):
    """
    –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–û –Ω–∞—Å".
    –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ, —Ç–∞–∫ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —à–∞–±–ª–æ–Ω
    —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ get_context_data().
    """
    template_name = "core/about_us.html"

    def get_context_data(self, **kwargs):
        """
        –§–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —à–∞–±–ª–æ–Ω–∞.
        """
        context = super().get_context_data(**kwargs)
        
        context['company_name'] = "–ë–∞—Ä–±–µ—Ä—à–æ–ø '–ê—Ä–±—É–∑'"
        context['start_year'] = 2010
        context['current_year'] = datetime.date.today().year
        context['years_on_market'] = datetime.date.today().year - context['start_year']
        context['page_title'] = "–û –Ω–∞—Å - –ë–∞—Ä–±–µ—Ä—à–æ–ø '–ê—Ä–±—É–∑'"
        context['contact_email'] = "contact@arbuz-barbershop.com"
        
        return context
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import AboutUsView

urlpatterns = [
    path("about-us/", AboutUsView.as_view(), name="about_us"),
]
```

–ó–¥–µ—Å—å `get_context_data` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö (`company_name`), —Ç–∞–∫ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö (`years_on_market`) –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞.

#### –ü—Ä–∏–º–µ—Ä 3: –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ FBV –Ω–∞ `TemplateView` (`ThanksView`)

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ `thanks` –º–æ–≥ –±—ã—Ç—å Function-Based View, –Ω–æ –µ–≥–æ –ø–µ—Ä–µ–ø–∏—Å–∞–ª–∏ –Ω–∞ `TemplateView` –¥–ª—è –ª—É—á—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏:

```python
# core/views.py
from django.views.generic import TemplateView
from django.db.models import Count # –î–ª—è masters_count
from .models import Master # –î–ª—è masters_count

class ThanksView(TemplateView):
    template_name = "core/thanks.html"

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        
        masters_count = Master.objects.filter(is_active=True).count()
        context["masters_count"] = masters_count
        context["additional_message"] = "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –Ω–∞—à –ø–µ—Ä–≤–æ–∫–ª–∞—Å—Å–Ω—ã–π —Å–µ—Ä–≤–∏—Å!"
        
        if 'source' in kwargs:
            source_page = kwargs['source']
            if source_page == 'order':
                context['source_message'] = "–í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –ø—Ä–∏–Ω—è—Ç –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É."
            elif source_page == 'review':
                context['source_message'] = "–í–∞—à –æ—Ç–∑—ã–≤ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∏ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏."
            else:
                context['source_message'] = f"–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –≤–∞—à–µ –¥–µ–π—Å—Ç–≤–∏–µ, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: {source_page}."
        else:
            context['source_message'] = "–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ!"
            
        return context
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import ThanksView

urlpatterns = [
    path("thanks/", ThanksView.as_view(), name="thanks"),
    path("thanks/<str:source>/", ThanksView.as_view(), name="thanks_with_source"),
]
```

–ó–¥–µ—Å—å `get_context_data` —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Å—Ç–µ—Ä–æ–≤) –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL (`source`).

## 3. DetailView (`django.views.generic.DetailView`)

`DetailView` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–¥–Ω–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –æ–±—ä–µ–∫—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ (PK) –∏–ª–∏ slug, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –≤ URL.

### –ê—Ç—Ä–∏–±—É—Ç—ã

* **`model`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –º–æ–¥–µ–ª—å, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç.
* **`template_name`**: –ò–º—è —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, Django –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—â–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ –ø—É—Ç–∏ `<app_label>/<model_name_lowercase>_detail.html` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `core/order_detail.html`).
* **`pk_url_kwarg`**: –ò–º—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ URL, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á –æ–±—ä–µ–∫—Ç–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'pk'`. –ï—Å–ª–∏ –≤ URL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `order_id`), –µ–≥–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∑–¥–µ—Å—å.
* **`slug_url_kwarg`**: –ò–º—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ URL, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç slug –æ–±—ä–µ–∫—Ç–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'slug'`.
* **`slug_field`**: –ò–º—è –ø–æ–ª—è –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç slug. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'slug'`.
* **`context_object_name`**: –ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –ø–æ–¥ –∫–æ—Ç–æ—Ä–æ–π –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —à–∞–±–ª–æ–Ω–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ –∏–º—è –º–æ–¥–µ–ª–∏ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `order` –¥–ª—è –º–æ–¥–µ–ª–∏ `Order`).
* **`extra_context`**: –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

### –ú–µ—Ç–æ–¥—ã

* **`get_queryset(self)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç QuerySet, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, `select_related` –∏–ª–∏ `prefetch_related` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
* **`get_object(self, queryset=None)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –Ω–µ –ø–æ PK/slug, –∞ –ø–æ –¥—Ä—É–≥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º), –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥.
* **`get_context_data(self, **kwargs)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —à–∞–±–ª–æ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é —Å –æ—Å–Ω–æ–≤–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º.

### –ó–∞—â–∏—Ç–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π

#### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LoginRequiredMixin` –∏–∑ `django.contrib.auth.mixins`. –≠—Ç–æ—Ç –º–∏–∫—Å–∏–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞.

```python
# core/views.py
from django.contrib.auth.mixins import LoginRequiredMixin
from django.views.generic import DetailView
from .models import Order

class OrderDetailView(LoginRequiredMixin, DetailView):
    model = Order
    template_name = "core/order_detail.html"
    pk_url_kwarg = "order_id"  # –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ pk –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –∏–∑ order_id –≤ URL
```

#### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å –æ—Ç –ù–ï `is_staff`?

–ï—Å—Ç—å –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `UserPassesTestMixin`**: –≠—Ç–æ—Ç –º–∏–∫—Å–∏–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ `test_func()`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True` –∏–ª–∏ `False`. –ï—Å–ª–∏ `False`, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `handle_no_permission()`.

    ```python
    # core/views.py
    from django.contrib.auth.mixins import UserPassesTestMixin
    from django.shortcuts import redirect
    from django.contrib import messages

    class StaffRequiredMixin(UserPassesTestMixin):
        """
        –ú–∏–∫—Å–∏–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º (is_staff).
        –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ.
        """
        def test_func(self):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º
            return self.request.user.is_authenticated and self.request.user.is_staff

        def handle_no_permission(self):
            # –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ test_func –≤–µ—Ä–Ω—É–ª False
            messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
            return redirect("landing") # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ 'landing' - —ç—Ç–æ –∏–º—è URL –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    ```

    –ó–∞—Ç–µ–º –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–∏–∫—Å–∏–Ω –≤ —Å–≤–æ–∏—Ö CBV:

    ```python
    # core/views.py
    class OrderDetailView(LoginRequiredMixin, StaffRequiredMixin, DetailView):
        model = Order
        template_name = "core/order_detail.html"
        pk_url_kwarg = "order_id"
    ```

2. **–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ `dispatch`**: –í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä—è–º–æ –≤ –º–µ—Ç–æ–¥ `dispatch` –≤–∞—à–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.

    ```python
    # core/views.py
    from django.contrib.auth.mixins import LoginRequiredMixin
    from django.views.generic import DetailView
    from django.shortcuts import redirect
    from django.contrib import messages
    # from django.http import Http403 # –ú–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è Http403
    
    class OrderDetailView(LoginRequiredMixin, DetailView):
        model = Order
        template_name = "core/order_detail.html"
        pk_url_kwarg = "order_id"
    
        def dispatch(self, request, *args, **kwargs):
            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—ç—Ç–æ –¥–µ–ª–∞–µ—Ç LoginRequiredMixin,
            # –Ω–æ –µ—Å–ª–∏ –±—ã –µ–≥–æ –Ω–µ –±—ã–ª–æ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—ã–ª–∞ –±—ã –∑–¥–µ—Å—å: if not request.user.is_authenticated:)
            # –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º
            if not request.user.is_staff:
                messages.error(request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.")
                return redirect("landing") 
                # –ò–ª–∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –≤—ã–∑–≤–∞—Ç—å Http403: from django.http import Http403; raise Http403("–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
            
            # –ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, –≤—ã–∑—ã–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –º–µ—Ç–æ–¥ dispatch,
            # –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –≤—ã–∑–æ–≤–µ—Ç get(), post() –∏ —Ç.–¥.
            return super().dispatch(request, *args, **kwargs)
    ```

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

#### `OrderDetailView`

```python
# core/views.py
from django.contrib.auth.mixins import LoginRequiredMixin
from django.views.generic import DetailView
from .models import Order
from django.shortcuts import redirect
from django.contrib import messages

class OrderDetailView(LoginRequiredMixin, DetailView):
    model = Order
    template_name = "core/order_detail.html"
    pk_url_kwarg = "order_id"

    def dispatch(self, request, *args, **kwargs):
        if not request.user.is_staff:
            messages.error(request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.")
            return redirect("landing") 
        return super().dispatch(request, *args, **kwargs)
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import OrderDetailView

urlpatterns = [
    path("orders/<int:order_id>/", OrderDetailView.as_view(), name="order_detail"),
]
```

–ó–¥–µ—Å—å `pk_url_kwarg` —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `order_id` –≤ URL. –ú–µ—Ç–æ–¥ `dispatch` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`is_staff`).

#### `ServiceDetailView`

```python
# core/views.py
from django.views.generic import DetailView
from .models import Service

class ServiceDetailView(DetailView):
    """
    –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å–ª—É–≥–µ.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å Service –∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∏–º—è —à–∞–±–ª–æ–Ω–∞.
    –í —à–∞–±–ª–æ–Ω –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –æ–±—ä–µ–∫—Ç service (–∏–º—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π).
    """
    model = Service
    template_name = 'core/service_detail.html'
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import ServiceDetailView

urlpatterns = [
    path("service/<int:pk>/", ServiceDetailView.as_view(), name="service_detail"),
]
```

–ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `pk` –≤ URL, –ø–æ—ç—Ç–æ–º—É `pk_url_kwarg` –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

## 4. ListView (`django.views.generic.ListView`)

`ListView` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è QuerySet, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

### –ê—Ç—Ä–∏–±—É—Ç—ã

* **`model`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –º–æ–¥–µ–ª—å, –æ–±—ä–µ–∫—Ç—ã –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è.
* **`queryset`**: –ú–æ–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å QuerySet –≤–º–µ—Å—Ç–æ `model`. –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω, `model` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.
* **`template_name`**: –ò–º—è —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Django –∏—â–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ –ø—É—Ç–∏ `<app_label>/<model_name_lowercase>_list.html` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `core/order_list.html`).
* **`context_object_name`**: –ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –ø–æ–¥ –∫–æ—Ç–æ—Ä–æ–π —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —à–∞–±–ª–æ–Ω–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ `object_list`.
* **`paginate_by`**: –¶–µ–ª–æ–µ —á–∏—Å–ª–æ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏.
* **`ordering`**: –°–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ QuerySet. –ù–∞–ø—Ä–∏–º–µ—Ä, `['name', '-price']`.
* **`extra_context`**: –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

### –ú–µ—Ç–æ–¥—ã

* **`get_queryset(self)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç QuerySet –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –≠—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –ø–æ–∏—Å–∫–∞, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (`select_related`, `prefetch_related`).
* **`get_context_data(self, **kwargs)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —à–∞–±–ª–æ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é —Å–æ —Å–ø–∏—Å–∫–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å—á–µ—Ç—á–∏–∫–∏).

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

#### `ServicesListView`

–≠—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ–Ω—è–µ—Ç Function-Based View `services_list`.

```python
# core/views.py
from django.contrib.auth.mixins import UserPassesTestMixin, LoginRequiredMixin
from django.views.generic import ListView
from .models import Service
from django.shortcuts import redirect
from django.contrib import messages

class StaffRequiredMixin(UserPassesTestMixin):
    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff

    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
        return redirect("landing")

class ServicesListView(StaffRequiredMixin, ListView):
    model = Service
    template_name = "core/services_list.html"
    context_object_name = "services"
    extra_context = {
        "title": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏",
    }
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import ServicesListView

urlpatterns = [
    path("services/", ServicesListView.as_view(), name="services_list"),
]
```

–ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `StaffRequiredMixin` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. `context_object_name` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `'services'`, —á—Ç–æ–±—ã –≤ —à–∞–±–ª–æ–Ω–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∫–∞–∫ `{{ services }}`. `extra_context` –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.

#### `OrdersListView`

–≠—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ–Ω—è–µ—Ç Function-Based View `orders_list` –∏ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

```python
# core/views.py
from django.contrib.auth.mixins import UserPassesTestMixin, LoginRequiredMixin
from django.views.generic import ListView
from .models import Order, Master, Service # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –º–æ–¥–µ–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
from django.db.models import Q, F # –î–ª—è Q-–æ–±—ä–µ–∫—Ç–æ–≤ –∏ F-–≤—ã—Ä–∞–∂–µ–Ω–∏–π
from django.shortcuts import redirect
from django.contrib import messages

class StaffRequiredMixin(UserPassesTestMixin):
    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff

    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
        return redirect("landing")

class OrdersListView(StaffRequiredMixin, ListView):
    model = Order
    template_name = "core/orders_list.html"
    context_object_name = "orders"

    def get_queryset(self):
        """
        –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ get_queryset –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ —Å –∂–∞–¥–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –º–∞—Å—Ç–µ—Ä–æ–≤ –∏ —É—Å–ª—É–≥.
        –ê —Ç–∞–∫ –∂–µ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞.
        """
        all_orders = (
            Order.objects.select_related("master").prefetch_related("services").all()
        )

        search_query = self.request.GET.get("search", None)

        if search_query:
            check_boxes = self.request.GET.getlist("search_in")
            filters = Q()

            if "phone" in check_boxes:
                filters |= Q(phone__icontains=search_query)
            if "name" in check_boxes:
                filters |= Q(client_name__icontains=search_query)
            if "comment" in check_boxes:
                filters |= Q(comment__icontains=search_query)

            if filters:
                all_orders = all_orders.filter(filters)

        return all_orders
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import OrdersListView

urlpatterns = [
    path("orders/", OrdersListView.as_view(), name="orders_list"),
]
```

–ó–¥–µ—Å—å `get_queryset` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–Ω–µ–µ –±—ã–ª–∞ –≤ Function-Based View. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `select_related` –∏ `prefetch_related` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Class-Based Views –≤ Django –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –º–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π —Å–ø–æ—Å–æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π. –ò—Å–ø–æ–ª—å–∑—É—è –±–∞–∑–æ–≤—ã–µ `View`, `TemplateView`, `DetailView` –∏ `ListView`, –∞ —Ç–∞–∫–∂–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–∏–∫—Å–∏–Ω—ã, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–∏—Å—Ç—ã–π, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏ –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∫–æ–¥. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω—É–∂–¥—ã –ø—Ä–æ–µ–∫—Ç–∞, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã —É–≥–ª—É–±–∏–º—Å—è –≤ Class-Based Views, –∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞—é—Ç —Ä–∞–±–æ—Ç—É —Å —Ñ–æ—Ä–º–∞–º–∏ –∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: `CreateView` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π, `UpdateView` –¥–ª—è –∏—Ö —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –º–æ—â–Ω—ã–π `FormMixin`, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–≥–∏—Ö CBV, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ñ–æ—Ä–º–∞–º–∏.

## 1. CreateView (`django.views.generic.edit.CreateView`)

`CreateView` ‚Äî —ç—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–æ–¥–µ–ª–∏ —Å –ø–æ–º–æ—â—å—é —Ñ–æ—Ä–º—ã. –û–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—É—Å—Ç–æ–π —Ñ–æ—Ä–º—ã (GET-–∑–∞–ø—Ä–æ—Å) –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ (POST-–∑–∞–ø—Ä–æ—Å).

### –ê—Ç—Ä–∏–±—É—Ç—ã

* **`model`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –º–æ–¥–µ–ª—å, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç. –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –º–æ–¥–µ–ª—å—é, –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å.
* **`form_class`**: –ö–ª–∞—Å—Å —Ñ–æ—Ä–º—ã, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, Django –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Ç—å `ModelForm` –Ω–∞ –æ—Å–Ω–æ–≤–µ `model` –∏ `fields`.
* **`fields`**: –°–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ —Ñ–æ—Ä–º—É. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ `form_class` –Ω–µ —É–∫–∞–∑–∞–Ω. **–í–∞–∂–Ω–æ: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `__all__` –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –±–µ–∑ —è–≤–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.**
* **`template_name`**: –ò–º—è —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—ã. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Django –∏—â–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ –ø—É—Ç–∏ `<app_label>/<model_name_lowercase>_form.html` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `core/order_form.html`).
* **`success_url`**: URL, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `django.urls.reverse_lazy` –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è URL.
* **`extra_context`**: –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞.

### –ú–µ—Ç–æ–¥—ã

* **`form_valid(self, form)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ñ–æ—Ä–º–∞ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `success_url`. –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ –∞–≤—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞).
* **`form_invalid(self, form)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ñ–æ—Ä–º–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–æ—Ä–º—É —Å –æ—à–∏–±–∫–∞–º–∏. –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫).
* **`get_form_class(self)`**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª–∞—Å—Å —Ñ–æ—Ä–º—ã.
* **`get_initial(self)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è —Ñ–æ—Ä–º—ã.
* **`get_form_kwargs(self)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ñ–æ—Ä–º—ã.
* **`get_success_url(self)`**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å URL –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è.

### –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞?

`CreateView` –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª—é–±—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

* –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ (`Order`).
* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π —É—Å–ª—É–≥–∏ (`Service`).
* –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞ (`Master`).
* –§–æ—Ä–º–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –æ—Ç–∑—ã–≤–∞ (`Review`).

### –î–∏–∞–≥—Ä–∞–º–º–∞

```mermaid
sequenceDiagram
    participant üë§ as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant üåê as Browser
    participant üöÄ as Django URLs
    participant üìù as ReviewCreateView
    participant üìã as ReviewModelForm
    participant üóÑÔ∏è as Review Model
    participant üíæ as Database
    participant üí¨ as Messages Framework
    participant üìÑ as Template Engine

    Note over üë§, üìÑ: üéØ GET –∑–∞–ø—Ä–æ—Å - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã
    
    üë§->>üåê: GET /review/create/
    üåê->>üöÄ: HTTP Request
    üöÄ->>üìù: dispatch() ‚û°Ô∏è get()
    
    üìù->>üìù: get_context_data(**kwargs) üìä
    Note right of üìù: context["title"] = "–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤"<br/>context["button_text"] = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤"
    
    üìù->>üìã: ReviewModelForm() üèóÔ∏è
    üìã->>üóÑÔ∏è: Meta.model = Review
    üìã->>üìã: fields = ["client_name", "text", ...]
    üìã-->>üìù: form instance
    
    üìù->>üìÑ: render(template_name="review_form.html")
    üìÑ-->>üåê: HTML with form
    üåê-->>üë§: üìã –§–æ—Ä–º–∞ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è

    Note over üë§, üìÑ: ‚úÖ POST –∑–∞–ø—Ä–æ—Å - —É—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
    
    üë§->>üåê: POST /review/create/ (valid data)
    üåê->>üöÄ: HTTP Request with form data
    üöÄ->>üìù: dispatch() ‚û°Ô∏è post()
    
    üìù->>üìã: ReviewModelForm(request.POST, request.FILES)
    üìã->>üìã: is_valid() ‚úÖ
    üìã->>üóÑÔ∏è: clean_data validation
    üóÑÔ∏è-->>üìã: ‚úÖ Valid
    üìã-->>üìù: form.is_valid() = True
    
    üìù->>üìù: form_valid(form) üéâ
    üìù->>üí¨: messages.success("–û—Ç–∑—ã–≤ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω")
    üìù->>üìù: super().form_valid(form)
    
    Note right of üìù: CreateView.form_valid():
    üìù->>üìã: form.save() üíæ
    üìã->>üóÑÔ∏è: Review.objects.create()
    üóÑÔ∏è->>üíæ: INSERT INTO review_review
    üíæ-->>üóÑÔ∏è: ‚úÖ Saved
    üóÑÔ∏è-->>üìã: Review instance
    üìã-->>üìù: saved object
    
    üìù->>üìù: get_success_url() üéØ
    Note right of üìù: success_url = reverse_lazy("thanks")
    
    üìù-->>üåê: HttpResponseRedirect("/thanks/")
    üåê-->>üë§: üéâ Redirect to success page

    Note over üë§, üìÑ: ‚ùå POST –∑–∞–ø—Ä–æ—Å - –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    
    üë§->>üåê: POST /review/create/ (invalid data)
    üåê->>üöÄ: HTTP Request with invalid data
    üöÄ->>üìù: dispatch() ‚û°Ô∏è post()
    
    üìù->>üìã: ReviewModelForm(request.POST, request.FILES)
    üìã->>üìã: is_valid() ‚ùå
    üìã->>üóÑÔ∏è: field validation
    üóÑÔ∏è-->>üìã: ‚ùå Validation errors
    üìã-->>üìù: form.is_valid() = False
    
    üìù->>üìù: form_invalid(form) ‚ö†Ô∏è
    üìù->>üí¨: messages.error("–§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")
    üìù->>üìù: super().form_invalid(form)
    
    Note right of üìù: CreateView.form_invalid():
    üìù->>üìù: get_context_data(form=form)
    üìù->>üìÑ: render(form with errors)
    üìÑ-->>üåê: HTML with form + errors
    üåê-->>üë§: ‚ùå –§–æ—Ä–º–∞ —Å –æ—à–∏–±–∫–∞–º–∏

    Note over üë§, üìÑ: üìä –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    Note over üìù: üèóÔ∏è CreateView –º–µ—Ç–æ–¥—ã:<br/>‚Ä¢ get_context_data()<br/>‚Ä¢ form_valid()<br/>‚Ä¢ form_invalid()
    Note over üìã: üõ°Ô∏è ModelForm —Ñ—É–Ω–∫—Ü–∏–∏:<br/>‚Ä¢ is_valid()<br/>‚Ä¢ save()<br/>‚Ä¢ clean_data
    Note over üóÑÔ∏è: üìù Review Model –ø–æ–ª—è:<br/>‚Ä¢ text, client_name<br/>‚Ä¢ master, photo, rating<br/>‚Ä¢ created_at, is_published
```

### –§–∞–Ω—Ç–∞–∑–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ

–í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –µ—Å—Ç—å Function-Based Views –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ (`order_create`) –∏ —É—Å–ª—É–≥–∏ (`service_create`). –ú—ã –º–æ–≥–ª–∏ –±—ã –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∏—Ö –Ω–∞ `CreateView`, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∫–æ–¥ –±–æ–ª–µ–µ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º Django.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—Å–ª—É–≥–∏:

```python
# core/views.py (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä)
from django.views.generic.edit import CreateView
from .models import Service
from .forms import ServiceForm
from django.urls import reverse_lazy
from django.contrib.auth.mixins import LoginRequiredMixin, UserPassesTestMixin
from django.contrib import messages
from django.shortcuts import redirect

# –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π StaffRequiredMixin
class StaffRequiredMixin(UserPassesTestMixin):
    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff
    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
        return redirect("landing")

class ServiceCreateView(StaffRequiredMixin, CreateView):
    model = Service
    form_class = ServiceForm # –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—à—É —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ–æ—Ä–º—É
    template_name = "core/service_form.html" # –®–∞–±–ª–æ–Ω –¥–ª—è —Ñ–æ—Ä–º—ã
    success_url = reverse_lazy("services_list") # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        context["title"] = "–°–æ–∑–¥–∞–Ω–∏–µ —É—Å–ª—É–≥–∏"
        context["button_txt"] = "–°–æ–∑–¥–∞—Ç—å"
        return context

    def form_valid(self, form):
        # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ —É—Å–ª—É–≥–∏
        # form.instance.created_by = self.request.user
        messages.success(self.request, f"–£—Å–ª—É–≥–∞ '{form.cleaned_data['name']}' —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!")
        return super().form_valid(form)
```

–ò –≤ `core/urls.py`:

```python
# core/urls.py (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä)
from django.urls import path
from .views import ServiceCreateView

urlpatterns = [
    path("service_create_cbv/", ServiceCreateView.as_view(), name="service_create_cbv"),
]
```

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏–ª–æ –±—ã –∫–æ–¥ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Function-Based View, —É–±—Ä–∞–≤ —Ä—É—á–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É GET/POST –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã.

```python
    def get_form_class(self):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä form_mode –≤ URL –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω—É–∂–Ω—É—é —Ñ–æ—Ä–º—É
        2 –≤–∞—Ä–∏–∞–Ω—Ç–∞: "normal" –∏ "easy"
        """
        form_mode = self.kwargs.get("form_mode")
        if form_mode == "normal":
            return ServiceForm
        
        elif form_mode == "easy":
            return ServiceEasyForm
```

–ü–æ–∑–≤–æ–ª–∏—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ URL –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã.

## 2. UpdateView (`django.views.generic.edit.UpdateView`)

`UpdateView` ‚Äî —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–æ–¥–µ–ª–∏. –û–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –æ–±—ä–µ–∫—Ç (GET-–∑–∞–ø—Ä–æ—Å), –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–æ—Ä–º—É —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ (POST-–∑–∞–ø—Ä–æ—Å).

### –ê—Ç—Ä–∏–±—É—Ç—ã

* **`model`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –º–æ–¥–µ–ª—å, –æ–±—ä–µ–∫—Ç –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è.
* **`form_class`**: –ö–ª–∞—Å—Å —Ñ–æ—Ä–º—ã, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç `ModelForm`.
* **`fields`**: –°–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —Ñ–æ—Ä–º—ã, –µ—Å–ª–∏ `form_class` –Ω–µ —É–∫–∞–∑–∞–Ω.
* **`template_name`**: –ò–º—è —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—ã. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Django –∏—â–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ –ø—É—Ç–∏ `<app_label>/<model_name_lowercase>_form.html`.
* **`pk_url_kwarg`**: –ò–º—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ URL –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'pk'`.
* **`slug_url_kwarg`**: –ò–º—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ URL –¥–ª—è slug. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'slug'`.
* **`success_url`**: URL –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
* **`context_object_name`**: –ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –ø–æ–¥ –∫–æ—Ç–æ—Ä–æ–π –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —à–∞–±–ª–æ–Ω–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ –∏–º—è –º–æ–¥–µ–ª–∏ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ.
* **`extra_context`**: –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

### –ú–µ—Ç–æ–¥—ã

* **`form_valid(self, form)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ñ–æ—Ä–º–∞ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç.
* **`get_object(self, queryset=None)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞.
* **`get_form_class(self)`**, **`get_initial(self)`**, **`get_form_kwargs(self)`**, **`get_success_url(self)`**: –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã –º–µ—Ç–æ–¥–∞–º –≤ `CreateView`.

### –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞?

`UpdateView` –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å:

* –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞ (`Order`).
* –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —É—Å–ª—É–≥–∏ (`Service`).
* –§–æ—Ä–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∞—Å—Ç–µ—Ä–µ (`Master`).
* –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ (`Review`).

### –§–∞–Ω—Ç–∞–∑–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ

–£ –Ω–∞—Å –µ—Å—Ç—å Function-Based View `service_update`. –ï–≥–æ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –Ω–∞ `UpdateView`.

```python
# core/views.py (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä)
from django.views.generic.edit import UpdateView
from .models import Service
from .forms import ServiceForm
from django.urls import reverse_lazy
from django.contrib.auth.mixins import LoginRequiredMixin, UserPassesTestMixin
from django.contrib import messages
from django.shortcuts import redirect

# –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π StaffRequiredMixin
class StaffRequiredMixin(UserPassesTestMixin):
    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff
    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
        return redirect("landing")

class ServiceUpdateView(StaffRequiredMixin, UpdateView):
    model = Service
    form_class = ServiceForm
    template_name = "core/service_form.html"
    pk_url_kwarg = "service_id" # –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ PK –±–µ—Ä–µ—Ç—Å—è –∏–∑ service_id –≤ URL
    success_url = reverse_lazy("services_list")

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        context["title"] = f"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ {self.object.name}"
        context["button_txt"] = "–û–±–Ω–æ–≤–∏—Ç—å"
        return context

    def form_valid(self, form):
        messages.success(self.request, f"–£—Å–ª—É–≥–∞ '{form.cleaned_data['name']}' —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!")
        return super().form_valid(form)
```

–ò –≤ `core/urls.py`:

```python
# core/urls.py (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä)
from django.urls import path
from .views import ServiceUpdateView

urlpatterns = [
    path("service_update_cbv/<int:service_id>/", ServiceUpdateView.as_view(), name="service_update_cbv"),
]
```

–≠—Ç–æ —Ç–∞–∫–∂–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥, —Ç–∞–∫ –∫–∞–∫ `UpdateView` –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è –≤—Å—é —Ä—É—Ç–∏–Ω—É –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—ä–µ–∫—Ç–∞, –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é —Ñ–æ—Ä–º—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π.

## 3. FormMixin (`django.views.generic.edit.FormMixin`)

`FormMixin` ‚Äî —ç—Ç–æ –º–∏–∫—Å–∏–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–∞–º–∏ –≤ Class-Based Views. –û–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Å–∞–º –ø–æ —Å–µ–±–µ, –Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã –∏ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–º. `CreateView` –∏ `UpdateView` (–∞ —Ç–∞–∫–∂–µ `FormView`) –Ω–∞—Å–ª–µ–¥—É—é—Ç –æ—Ç `FormMixin`.

### –ß—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –¥–∞—Ç—å?

`FormMixin` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

* **–ê—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º—ã**: `form_class`, `initial`, `success_url`.
* **–ú–µ—Ç–æ–¥—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–º—ã**:
  * `get_form(self, form_class=None)`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä —Ñ–æ—Ä–º—ã.
  * `get_form_class(self)`: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª–∞—Å—Å —Ñ–æ—Ä–º—ã.
  * `get_form_kwargs(self)`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ —Ñ–æ—Ä–º—ã.
  * `get_initial(self)`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ñ–æ—Ä–º—ã.
  * `form_valid(self, form)`: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω–æ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ–æ—Ä–º—É.
  * `form_invalid(self, form)`: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—É—é —Ñ–æ—Ä–º—É.
  * `get_success_url(self)`: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç URL –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ `FormMixin` –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º—ã –∫ –ª—é–±–æ–º—É –¥—Ä—É–≥–æ–º—É CBV. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã –º–æ–∂–µ—Ç–µ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –µ–≥–æ —Å `DetailView`, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ñ–æ—Ä–º—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å –¥–µ—Ç–∞–ª—è–º–∏ –æ–±—ä–µ–∫—Ç–∞.

### –ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞—è–≤–∫–∏ (`OrderDetailView`)

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –¥–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –∑–∞—è–≤–∫–∞–º –ø—Ä—è–º–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞. –£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å `OrderDetailView`, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫–∞–∑–µ. –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `FormMixin` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.

–î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:

1. **–ú–æ–¥–µ–ª—å –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤**: –î–æ–ø—É—Å—Ç–∏–º, `Comment` —Å –ø–æ–ª—è–º–∏ `text`, `order` (ForeignKey –∫ `Order`), `author` (ForeignKey –∫ `User`).
2. **–§–æ—Ä–º–∞ –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤**: `CommentForm`, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –º–æ–¥–µ–ª–∏ `Comment`.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ `FormMixin` (Function-Based View –ø–æ–¥—Ö–æ–¥ –≤–Ω—É—Ç—Ä–∏ CBV)

–ï—Å–ª–∏ –±—ã –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `FormMixin`, –Ω–∞–º –ø—Ä–∏—à–ª–æ—Å—å –±—ã –≤—Ä—É—á–Ω—É—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ–æ—Ä–º—É –≤ –º–µ—Ç–æ–¥–µ `post` –Ω–∞—à–µ–≥–æ `OrderDetailView`:

```python
# core/views.py (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –±–µ–∑ FormMixin)
from django.views.generic import DetailView
from django.contrib.auth.mixins import LoginRequiredMixin, UserPassesTestMixin
from django.shortcuts import redirect
from django.contrib import messages
# from .models import Order, Comment # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ Comment —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
# from .forms import CommentForm # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ CommentForm —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

class OrderDetailView(LoginRequiredMixin, UserPassesTestMixin, DetailView):
    # ... (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –º–µ—Ç–æ–¥—ã) ...
    # model = Order
    # template_name = "core/order_detail.html"
    # pk_url_kwarg = "order_id"

    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff

    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.")
        return redirect("landing")

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—É—é —Ñ–æ—Ä–º—É –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –¥–ª—è GET-–∑–∞–ø—Ä–æ—Å–∞
        context['comment_form'] = CommentForm()
        context['comments'] = self.object.comments.all().order_by('-created_at') # –ï—Å–ª–∏ —É Order –µ—Å—Ç—å related_name 'comments'
        return context

    def post(self, request, *args, **kwargs):
        self.object = self.get_object() # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –æ–±—ä–µ–∫—Ç Order
        comment_form = CommentForm(request.POST) # –°–æ–∑–¥–∞–µ–º —Ñ–æ—Ä–º—É –∏–∑ POST-–¥–∞–Ω–Ω—ã—Ö

        if comment_form.is_valid():
            comment = comment_form.save(commit=False)
            comment.order = self.object
            comment.author = request.user
            comment.save()
            messages.success(request, "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!")
            return redirect(self.object.get_absolute_url()) # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Ç—É –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        else:
            messages.error(request, "–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.")
            context = self.get_context_data() # –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ–æ—Ä–º—É —Å –æ—à–∏–±–∫–∞–º–∏
            context['comment_form'] = comment_form
            return self.render_to_response(context) # –†–µ–Ω–¥–µ—Ä–∏–º —à–∞–±–ª–æ–Ω —Å –æ—à–∏–±–∫–∞–º–∏
```

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–º—ã, –≤–∫–ª—é—á–∞—è —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ —Ñ–æ—Ä–º—ã, –ø—Ä–æ–≤–µ—Ä–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —à–∞–±–ª–æ–Ω–∞ —Å –æ—à–∏–±–∫–∞–º–∏.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å `FormMixin`

–ò—Å–ø–æ–ª—å–∑—É—è `FormMixin`, –º—ã –º–æ–∂–µ–º –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å —ç—Ç—É –ª–æ–≥–∏–∫—É, –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–≤ –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã –º–∏–∫—Å–∏–Ω—É:

```python
# core/views.py (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä —Å FormMixin)
from django.views.generic import DetailView
from django.views.generic.edit import FormMixin # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º FormMixin
from django.contrib.auth.mixins import LoginRequiredMixin, UserPassesTestMixin
from django.shortcuts import redirect
from django.contrib import messages
from django.urls import reverse # –î–ª—è get_success_url

# from .models import Order, Comment # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ Comment —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
# from .forms import CommentForm # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ CommentForm —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

class OrderDetailWithCommentView(LoginRequiredMixin, UserPassesTestMixin, FormMixin, DetailView):
    model = Order
    template_name = "core/order_detail.html"
    pk_url_kwarg = "order_id"
    # –î–æ–±–∞–≤–ª—è–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã FormMixin
    form_class = CommentForm # –ö–ª–∞—Å—Å —Ñ–æ—Ä–º—ã –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    success_url = "/" # –í—Ä–µ–º–µ–Ω–Ω–æ, –±—É–¥–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ get_success_url

    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff

    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.")
        return redirect("landing")

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        # –ü–µ—Ä–µ–¥–∞–µ–º —Ñ–æ—Ä–º—É –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç. FormMixin –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç get_form()
        context['comment_form'] = self.get_form()
        # context['comments'] = self.object.comments.all().order_by('-created_at')
        return context

    def post(self, request, *args, **kwargs):
        # –ü–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç Order, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        self.object = self.get_object()
        # –°–æ–∑–¥–∞–µ–º —Ñ–æ—Ä–º—É, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥—ã FormMixin
        form = self.get_form()

        if form.is_valid():
            return self.form_valid(form)
        else:
            return self.form_invalid(form)

    def form_valid(self, form):
        # comment = form.save(commit=False)
        # comment.order = self.object
        # comment.author = self.request.user # –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        # comment.save()
        messages.success(self.request, "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!")
        return super().form_valid(form) # –í—ã–∑—ã–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π form_valid –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

    def get_success_url(self):
        # –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Ç—É –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞
        return reverse("order_detail", kwargs={"order_id": self.object.pk})
```

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ `FormMixin` –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã, –µ–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è. –ú—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º `post` –¥–ª—è –≤—ã–∑–æ–≤–∞ `form.is_valid()`, –∞ –∑–∞—Ç–µ–º `form_valid` –∏–ª–∏ `form_invalid`. `get_context_data` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ–æ—Ä–º—ã –≤ —à–∞–±–ª–æ–Ω, –∞ `get_success_url` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∫—É–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Å—Ç—ã–º –∏ –º–æ–¥—É–ª—å–Ω—ã–º.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

`CreateView` –∏ `UpdateView` —è–≤–ª—è—é—Ç—Å—è –º–æ—â–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π –≤ Django, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∫—Ä–∞—â–∞—è –æ–±—ä–µ–º —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞. `FormMixin` –∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º –∫ –ª—é–±—ã–º –¥—Ä—É–≥–∏–º Class-Based Views, –ø–æ–∑–≤–æ–ª—è—è —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —á–∏—Å—Ç—ã–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Django.
